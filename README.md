## Архитектура сетей

```
Дано

https://github.com/erlong15/otus-linux/tree/network
(ветка network)
Vagrantfile с начальным построением сети

inetRouter
centralRouter
centralServer
тестировалось на virtualbox

Планируемая архитектура
построить следующую архитектуру
Сеть office1
* 192.168.2.0/26 - dev
* 192.168.2.64/26 - test servers
* 192.168.2.128/26 - managers
* 192.168.2.192/26 - office hardware
Сеть office2
* 192.168.1.0/25 - dev
* 192.168.1.128/26 - test servers
* 192.168.1.192/26 - office hardware
Сеть central
* 192.168.0.0/28 - directors
* 192.168.0.32/28 - office hardware
* 192.168.0.64/26 - wifi

Office1 ---\
       ----> Central -- IRouter --> internet
Office2----/

Итого должны получится следующие сервера
* inetRouter
* centralRouter
* office1Router
* office2Router
* centralServer
* office1Server
* office2Server

Теоретическая часть
* Найти свободные подсети
* Посчитать сколько узлов в каждой подсети, включая свободные
* Указать broadcast адрес для каждой подсети
* проверить нет ли ошибок при разбиении

Практическая часть
* Соединить офисы в сеть согласно схеме и настроить роутинг
* Все сервера и роутеры должны ходить в инет через inetRouter
* Все сервера должны видеть друг друга
* у всех новых серверов отключить дефолт на нат (eth0), который вагрант поднимает для связи
* при нехватке сетевых интервейсов добавить по несколько адресов на интерфейс
Формат сдачи ДЗ - vagrant + ansible
```

### Теоретическая часть

* В таблице ниже свободные подсети именованы как **<свободный>**. Количество хостов и широковещательные адреса указаны также.

**central:**
| Наименование    | Подсеть          | Маска           | Первый хост   | Последний хост | Кол-во хостов | Широковещательный адрес |
|-----------------|:----------------:|:---------------:|:-------------:|:--------------:|:-------------:|:-----------------------:|
| directors       | 192.168.0.0/28   | 255.255.255.240 | 192.168.0.1   | 192.168.0.14   | 14            | 192.168.0.15            |
| **<свободный>** | 192.168.0.16/28  | 255.255.255.240 | 192.168.0.17  | 192.168.0.30   | 14            | 192.168.0.31            |
| office hardware | 192.168.0.32/28  | 255.255.255.240 | 192.168.0.33  | 192.168.0.46   | 14            | 192.168.0.47            |
| **<свободный>** | 192.168.0.48/28  | 255.255.255.240 | 192.168.0.49  | 192.168.0.62   | 14            | 192.168.0.63            |
| wifi            | 192.168.0.64/26  | 255.255.255.192 | 192.168.0.65  | 192.168.0.126  | 62            | 192.168.0.127           |
| **<свободный>** | 192.168.0.128/25 | 255.255.255.128 | 192.168.0.129 | 192.168.0.254  | 126           | 192.168.0.255           |
|||||| **244** ||

**office2:**
| Наименование    | Подсеть          | Маска           | Первый хост   | Последний хост | Кол-во хостов | Широковещательный адрес |
|-----------------|:----------------:|:---------------:|:-------------:|:--------------:|:-------------:|:-----------------------:|
| dev             | 192.168.1.0/25   | 255.255.255.128 | 192.168.1.1   | 192.168.1.126  | 126           | 192.168.1.127           |
| test servers    | 192.168.1.128/26 | 255.255.255.192 | 192.168.1.129 | 192.168.1.190  | 62            | 192.168.1.191           |
| office hardware | 192.168.1.192/26 | 255.255.255.192 | 192.168.1.193 | 192.168.1.254  | 62            | 192.168.1.255           |
|||||| **250** ||

**office1:**
| Наименование    | Подсеть          | Маска           | Первый хост   | Последний хост | Кол-во хостов | Широковещательный адрес |
|-----------------|:----------------:|:---------------:|:-------------:|:--------------:|:-------------:|:-----------------------:|
| dev             | 192.168.2.0/26   | 255.255.255.192 | 192.168.2.1   | 192.168.2.62   | 62            | 192.168.2.63            |
| test servers    | 192.168.2.64/26  | 255.255.255.192 | 192.168.2.65  | 192.168.2.126  | 62            | 192.168.2.127           |
| managers        | 192.168.2.128/26 | 255.255.255.192 | 192.168.2.129 | 192.168.2.190  | 62            | 192.168.2.191           |
| office hardware | 192.168.2.192/26 | 255.255.255.192 | 192.168.2.193 | 192.168.2.254  | 62            | 192.168.2.255           |
|||||| **248** ||

### Практическая часть

* Согласно схемы из ТЗ сделал детализированную схему топологии:

![image](https://raw.githubusercontent.com/mmmex/network/master/Network-diagram.png)

* Добавлена новая подсеть `routers`:

| Наименование    | Подсеть          | Маска           | Первый хост   | Последний хост | Кол-во хостов | Широковещательный адрес |
|-----------------|:----------------:|:---------------:|:-------------:|:--------------:|:-------------:|:-----------------------:|
| routers         | 192.168.255.8/29 | 255.255.255.248 | 192.168.255.9 | 192.168.255.14 | 6             | 192.168.255.15          |

* Таблица хостов:

| Имя хоста     | Адреса                                                                                 | Кол-во интерфейсов |
|:--------------|:---------------------------------------------------------------------------------------|:------------------:|
| inetRouter    | 192.168.255.1/30                                                                       | 1                  |
| centralRouter | 192.168.255.2/30, 192.168.255.9/29, 192.168.0.1/28, 192.168.0.33/28, 192.168.0.65/28   | 5                  |
| office1Router | 192.168.255.10/29, 192.168.2.1/26, 192.168.2.65/26, 192.168.2.129/26, 192.168.2.193/26 | 5                  |
| office2Router | 192.168.255.11/29, 192.168.1.193/26, 192.168.1.129/26, 192.168.1.1/25                  | 4                  |
| centralServer | 192.168.0.2/28                                                                         | 1                  |
| office1Server | 192.168.2.66/26                                                                        | 1                  |
| office2Server | 192.168.1.130/26                                                                       | 1                  |

* Для запуска стенда:

1. Необходимо склонировать репозиторий: `git clone https://github.com/mmmex/network`

2. Перейти в папку `network`: `cd network`

3. Выполнить запуск ВМ: `vagrant up`

4. После запуска выполним вход на ВМ, например `office2Server`: `vagrant ssh office2Server`
   - Проверим доступность сервера `office1Server` в соседнем офисе: `ping 192.168.2.66`
   - Проверим как выходим во внешний мир: `tracepath -n 8.8.8.8`
